#seleniumhub:
#  image: selenium/hub:2.53.0
#  ports:
#    - 4444:4444
#
#chromenode:
#  image: selenium/node-chrome:2.53.0
#  ports:
#    - 5900
#  links:
#    - seleniumhub:hub

  selenium:
    container_name: selenium
    image: selenium/standalone-chrome-debug:3.1.0-astatine
    shm_size: 1g
    ports:
      - 4444:4444
      - 5900:5900
    volumes:
      - ${PWD}/edit/test/protractor/files:/edit/files
      - ${PWD}/edit/test/protractor/images:/edit/images
      - ${PWD}/poller/images:/poller/images
      - /dev/shm:/dev/shm

  fre-hdm:
    container_name: fre-hdm
    build:
      context: fre-hdm
      args:
        - GITHUB_TOKEN=${GITHUB_TOKEN}
    image: quay.io/hearst/fre-theme-hdm
    ports:
      - 80
    volumes:
      - ${PWD}/fre-hdm:/var/www
    environment:
      - AMP_ELIGIBILITY=1
      - API_URLS=http://rover
      - ASSET_HOSTNAME=https://assets.hearstapps.net
      - BABOU_URLS=http://babou.hdmtools.com/api
      - BABOU_VERSION=v2
      - DATAMART_URLS=https://dev-buzzing.hearst.io
      - DATAMART_VERSION=v1
      - DIVERSION_URLS=http://diversion
      - DOORMAN_API_REDIRECT_URL=http://fre-hdm.docker
      - DOORMAN_URLS=http://rover
      - DOORMAN_VERSION=v2
      - ENSIGHTEN_ENABLED=1
      - EMBED_ICON_FONT=true
      - ESEARCH_URLS=http://seekr
      - HOMEPAGE_ITEMS_CACHE_KEY=homepage-items
      - LAZYLOAD_EMBEDS=true
      - LIST_AD_FREQUENCY=3
      - MASTER_RECORD_URLS=http://master-record
      - PUBLIC_IMAGE_HOSTNAME=http://hips.docker/hips/hdm-dev
      - REDIS_HOSTNAME=fre-redis
      - ROVER_API_REDIRECT_URL=http://fre-hdm.docker
      - ROVER_API_KEY=12345678
      - ROVER_API_SECRET=87654321
      - ROVER_URLS=http://rover
      - SELENIUM_ADDRESS=http://selenium.docker:4444/wd/hub
      - SHARE_COUNTS_URLS=https://hds-api.hearst.io/dev
      - SHOULD_USE_LEGACY_ID_BOUNDARY=0
      - SLIDE_AD_FREQUENCY=5
      - TYRION_URLS=http://tyrion
      - VIRTUAL_HOST=${CURRENT_SITE}.docker,fre-theme-hdm.docker,*.fre-theme-hdm.docker,fre-hdm.docker,*.fre-hdm.docker
      - YII_ENVIRONMENT=dev